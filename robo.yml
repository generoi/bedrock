machine_name: bedrock-playground
organization: generoi
theme_path: 'web/app/themes/wp-gds-theme'
placeholders:
  '%files': web/app/uploads/
env:
  '@ddev':
    host: 'bedrock-playground.ddev.site'
    wpcli: 'ddev exec wp-cli'
    path: /var/www/html
    url: 'http://bedrock-playground.ddev.site'
  '@vagrant':
    host: 'bedrock-playground.test'
    user: vagrant
    path: /var/www/wordpress
    url: 'http://bedrock-playground.test'
  '@staging':
    host: <staging-ip>
    user: bedrock-playground
    port: 22
    ssh: 'ssh -p 22'
    path: '/www/bedrock-playground_XYZ/public/current'
    url: 'https://staging-bedrock-playground.kinsta.cloud'
  '@production':
    host: <production-ip>
    user: tehdas
    port: 22
    ssh: 'ssh -p 22'
    path: '/www/bedrock-playground_XYZ/public/current'
    url: 'https://bedrock-playground.kinsta.cloud'
command:
  build:
    production:
      options:
        npm-script: 'build:production'
    development:
      options:
        npm-script: build
  deploy:
    options:
      uri: ${organization}/${machine_name}
    production:
      options:
        workflow: deploy_production.yml
    staging:
      options:
        workflow: deploy_staging.yml
  setup:
    options:
      theme-repository: false
      theme-branch: false
      no-commit: false
  search:
    replace:
      options:
        dirs:
          - .ddev
          - config
          - web/app/themes
          - web/app/mu-plugins
        exclude:
          - robo.yml
          - public
  db:
    options:
      exclude_tables:
        - wp_gf_entry
        - wp_gf_entry_meta
        - wp_gf_entry_notes
        - wp_gf_incomplete_submissions
        - wp_rg_incomplete_submissions
        - wp_rg_lead
        - wp_rg_lead_detail
        - wp_rg_lead_detail_long
        - wp_rg_lead_meta
        - wp_rg_lead_notes
        - wp_stream
        - wp_stream_meta
    pull:
      options:
        target: '@ddev'
    push:
      options:
        source: '@ddev'
  files:
    options:
      options:
        chmod: 'Dug=rwx,Do=rx,Fug=rw,Fo=r'
      exclude:
        - gravity_forms/
        - '*.webp'
        - '*-c-*.jpg'
        - '*-c-*.jpeg'
        - '*-c-*.png'
task:
  Remote:
    RsyncAlias:
      settings:
        progress: true
        humanReadable: true
  Wp:
    WpCliStack:
      settings:
        executable: ./vendor/bin/wp
